---
title: "Comparation Eukdetect VS Metaphlan"
author: "Laia Domingo Costa"
format: html
editor: visual
---

# Load libraries

```{r}
library(ggplot2)
```

# Load data

## Metaphlan

```{r}
metaplhan = read.csv("metaphlan_sgb_rel_abund_perc.tsv", sep = "\t")
# Get eukaryotes data only
condition = grepl("EUK.*", metaplhan$X)
rownames(metaplhan) = metaplhan$X
# Remove sample name column
metaplhan = metaplhan[,-1]
metaplhan = metaplhan[condition,]
# Remove non detected taxa
metaplhan = metaplhan[, colSums(metaplhan != 0) > 0]
```

## Eukdetect

```{r}
eukdetect = read.csv("presence_absence_genus_table.tsv", sep = "\t")
rownames(eukdetect) = eukdetect$Sample
# Remove sample name column
eukdetect = eukdetect[,-1]
# Remove non detected taxa
eukdetect = eukdetect[rowSums(eukdetect != 0) > 0, ]
```

# Perform comparation

```{r}
# Create presence/absence data frames
M = data.frame(samples = colnames(metaplhan), species = colSums(metaplhan != 0))
M$program = "Metaphlan"
E = data.frame(samples = rownames(eukdetect), species = rowSums(eukdetect != 0))
E$program = "EukDetect"

# Concatenate data frames
df_combined <- rbind(M, E)
rownames(df_combined) = NULL

# Histogram
ggplot(df_combined, aes(x = samples, y = species, fill = program)) +
  geom_col(position = "identity", alpha = 0.7) +
  labs(x = "Muestras",
       y = "NÃºmero de especies") +
  scale_fill_manual(values = c("Metaphlan" = "blue", "EukDetect" = "red")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggsave("EukdetectVSMetaphlan.png", width = 10, height = 6, units = "in", bg = "white")
```
